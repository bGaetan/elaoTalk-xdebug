<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Debug like a boss with Xdebug</title>

        <meta name="description" content="Debug like a boss with Xdebug">
        <meta name="author" content="Gaetan BUELLET">

        <meta name="apple-mobile-web-app-capable" content="yes"/>
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.min.css">
        <link rel="stylesheet" href="css/theme/default.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- If the query includes 'print-pdf', include the PDF print sheet -->
        <script>
            if (window.location.search.match(/print-pdf/gi)) {
                var link = document.createElement('link');
                link.rel = 'stylesheet';
                link.type = 'text/css';
                link.href = 'css/print/pdf.css';
                document.getElementsByTagName('head')[0].appendChild(link);
            }
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="reveal">

        <!-- SLIDE 1 -->
        <div class="slides">
            <section>
                <h1>Debug like a Boss <br>avec<br> XDEBUG</h1>
                <img src="images/chasseAuxBug.jpg" />
                <p> <a href="http://twitter.com/gaetanbuellet">@gaetanbuellet</a></small> </p>
            </section>

        <!-- SLIDE 2 -->
            <section>
                <h2>XDebug ? De quoi c'est</h2>
                <img src="images/cestquoi.jpg">
                <p class="fragment"></p>
                    <span class="fragment">Une extention PHP</span>
            </section>

            <!-- SLIDE 3 -->
            <section>
                <h2>Et ça m'apporte quoi ? </h2>

                <p class="fragment"></p>
                <ul>
                    <li class="fragment">Affichage des erreurs <span class="fragment">(Mais en plus joli)</span> </li>
                    <li class="fragment">var_dump amélioré</li>
                    <li class="fragment">Stack trace</li>
                    <li class="fragment">Code coverage</li>
                    <li class="fragment">Profiling</li>
                    <li class="fragment">Remote Debugging</li>
                </ul>
            </section>

            <!-- SLIDE 4 -->
            <section>
                <h2>Installation</h2>
                <ul class="fragment">
                    <li class about="fragment">Linux <span class="fragment">: apt-get install php5-debug (ou par pecl)</span></li>
                    <li class="fragment">MAC <span class="fragment">: Activer l'extention dans MAMP</span></li>
                    <li class="fragment">Windows <span class="fragment">: OSEF</span></li>
                </ul>
                <br><br>
                <p class="fragment">Et bien sure, on modifie le php.ini</p>
                <pre class="fragment">
                    <code>
[Xdebug]
zend_extension=/path/to/xdebug.so
                    </code>
                </pre>
                <span class="fragment">(find . -name xdebug.so -print)</span>
            </section>
            <!-- SLIDE 5 -->
            <section>
                <section>
                    <h2>Affichage des erreurs</h2>
                    <pre>
                        <code>
                            $a = 1;
                            $b = 2;
                            echo $x;
                        </code>
                    </pre>
                </section>
                <section>
                    <p>Configuration standard</p>
                    <img src="images/std-error.png" />
                </section>
                <section>
                    <p>Configuration affichage des variables</p>
                    <pre>
                        <code>
[Xdebug]
xdebug.show_local_vars=1
                        </code>

                    </pre>
                    <img src="images/erroWithDisplayedVariables.png" />
                </section>
                <section>
                    <p>Configuration affichage des variables superglobales</p>
                    <pre>
                        <code>
[Xdebug]
xdebug.dump.GET=*
xdebug.dump.SERVER=*
                        </code>

                    </pre>
                    <img src="images/superGlobalsErrors.png" />
                </section>
                <section>
                    <p>Configuration affichage des variables superglobales</p>
                    <pre>
                        <code>
[Xdebug]
xdebug.dump.GET=*
xdebug.dump.SERVER=REMOTE_ADDR, SERVER_NAME
                        </code>

                    </pre>
                    <img src="images/superGlobalsErrorsLigth.png" />
                </section>
            </section>
            <!-- SLIDE 6 -->
            <section>
                <section>
                    <h2>var_dump</h2>
                </section>
                <section>
                    <pre>
                        <code style="max-height: inherit">
class test {
    public $pub = false;
    private $priv = true;
    protected $prot = 42;
}
$t = new test;
$t->pub = $t;
$data = array(
    'one' => 'a somewhat long string!',
    'two' => array(
        'two.one' => array(
            'two.one.zero' => 210,
            'two.one.one' => array(
                'two.one.one.zero' => 3.141592564,
                'two.one.one.one'  => 2.7,
            ),
        ),
    ),
    'three' => $t,
    'four' => range(0, 5),
);
var_dump( $data );
                        </code>
                    </pre>

                </section>
                <section>
                    <img src="images/vardump.png" />
                </section>
                <section>
                    <h2>Paramétrage du var_dump() à la volée avec ini_set()</h2>
                    <ul class="fragment">
                        <li class="fragment">xdebug.var_display_max_children</li>
                        <li class="fragment">xdebug.var_display_max_data</li>
                        <li class="fragment">xdebug.var_display_max_depth</li>
                    </ul>
                </section>
                <section>
                    <img src="images/vardumpChildren.png" /> <br>
                    <img src="images/vardumData.png" />
                </section>
            </section>
            <!-- SLIDE 7 -->
            <section>
                <section>

                    <h2>Stack trace</h2>
                    <pre class="fragment">
                        <code>
class Chat {
    public function pousseUnCri() {
        echo CRI;
    }
}

require_once('Chat.php');
$garfield = new Chat('Garfield');
$garfield->pousseUnCri();
                        </code>
                    </pre>
                        <img class="fragment" src="images/stackTrace.png" />
                    </section>
                    <section>
                        <pre>
                            <code>
ini_set('xdebug.collect_params', 3);
ini_set('xdebug.show_mem_delta', 1);
ini_set('xdebug.trace_format', 2); // export au format html
xdebug_start_trace();
$str = "Xdebug";
function ret_ord( $c ) {
    return ord( $c );
}

foreach ( str_split( $str ) as $char ) {
    echo $char, ": ", ret_ord( $char ), "\n";
}
xdebug_stop_trace();
                            </code>
                        </pre>
                        <img class="fragment" src="images/stackTrace2.png">
                    </section>
            </section>
            <!-- SLIDE 8 -->
            <section>
                <h2>Profiler</h2>
                <pre>
                    <code>
[Xdebug]
xdebug.profiler_enable = 1
xdebug.profiler_append = 1
xdebug.profiler_output_dir = /tmp
xdebug.profiler_output_name = cachegrind.out.%p
                    </code>
                </pre>

            </section>
            <section>
                <section>
                    <h2>Remote debug</h2>
                    <img class="fragment" src="images/codeDebug.jpg" />
                </section>
                <section>
                    <img src="https://media.giphy.com/media/xR1nUJm9Uee3u/giphy.gif" />
                </section>
                <section>
                    <h2>Configuration</h2>
                    <pre class="fragment">
                        <code>
[Xdebug]
xdebug.remote_enable = 1 (default 0)
xdebug.remote_host = localhost
xdebug.remote_port = 9000
xdebug.remote_cookie_expire_time = 3600
xdebug.remote_mode = req ou jit (default req)
                        </code>
                    </pre>
                </section>
                <section>

                    <h2>Ligne de commande</h2>
                    <pre>
                        <code>
export XDEBUG_CONFIG="idekey=session_name"
php myscript.php
                        </code>
                    </pre>
                    <pre>
                        <code style="font-size: 0.8em">
export XDEBUG_CONFIG="idekey=session_name remote_host=localhost profiler_enable=1
                        </code>
                    </pre>
                </section>

                <section>

                    <h2>PHPSTORM COnfiguration</h2>
                        <img src="images/config_xdebug.png">
                </section>

                <section>

                    <h2>TADAAAAAA</h2>
                    <img src="images/debug.png">
                </section>

            </section>
            <!-- LAST SLIDE -->
            <section>
                <h1>Merci</h1>

                <h3>Des questions ?</h3>
            </section>

            <section>
                <h1>Noyeux Joel</h1>

                <img src="images/noel.jpg">
            </section>
        </div>
    </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.min.js"></script>

        <script>

        // Full list of configuration options available here:
        // https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize({
            controls: true,
            progress: true,
            history: true,
            center: true,

            theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
            transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

            // Parallax scrolling
            // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
            // parallaxBackgroundSize: '2100px 900px',

            // Optional libraries used to extend on reveal.js
            dependencies: [
                {
                    src: 'lib/js/classList.js', condition: function () {
                    return !document.body.classList;
                }
                },
                {
                    src: 'plugin/markdown/marked.js', condition: function () {
                    return !!document.querySelector('[data-markdown]');
                }
                },
                {
                    src: 'plugin/markdown/markdown.js', condition: function () {
                    return !!document.querySelector('[data-markdown]');
                }
                },
                {
                    src: 'plugin/highlight/highlight.js', async: true, callback: function () {
                    hljs.initHighlightingOnLoad();
                }
                },
                {
                    src: 'plugin/zoom-js/zoom.js', async: true, condition: function () {
                    return !!document.body.classList;
                }
                },
                {
                    src: 'plugin/notes/notes.js', async: true, condition: function () {
                    return !!document.body.classList;
                }
                }
            ]
        });

    </script>

    </body>
</html>
